<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>Growtopia Item Database</title>
</head>

<body>
	<h1>Growtopia Item Database</h1>

	<nav class="tableOfContents">
		<h2>All items</h2>
		<ul id="itemsList"></ul>
	</nav>

	<section id="itemInfoBoxes"></section>

	<script type="text/javascript">
		// NB: These are in any old order, we sort them later so they appear alphabetically.
		var items = {
			"Dirt": {rarity: 1, spawnsInWorld: "normal"},
			"Cave Background": {rarity: 1, spawnsInWorld: "normal"},
			"Rock": {rarity: 1, spawnsInWorld: "normal"},
			"Lava": {rarity: 1, spawnsInWorld: "normal"},
			"Crystal Block": {rarity: 100, spawnsInEvent: "Beautiful Crystal"},
			"Sand": {rarity: 1, spawnsInWorld: "Beach Blast"},
			"Ocean Rock": {rarity: 1, spawnsInWorld: "Beach Blast"},
			"Garbage": {rarity: 1},
			"Sandstone Wall": {rarity: 1, spawnsInWorld: "Desert Blast"},
			"Boulder": {rarity: 1, spawnsInWorld: "Desert Blast"},
			"Obelisk": {rarity: 30, spawnsInWorld: "Desert Blast"},

			"Door": {rarity: 2, splice: ["Dirt", "Cave Background"]},
			"Sign": {rarity: 2, splice: ["Rock", "Cave Background"]},
			"Grass": {rarity: 2, splice: ["Rock", "Dirt"]},
			"Wood Block": {rarity: 2, splice: ["Dirt", "Lava"]},
			"Glass Pane": {rarity: 2, splice: ["Rock", "Lava"]},
			"Lava Rock": {rarity: 2, splice: ["Cave Background", "Lava"]},

			"Daisy": {rarity: 3, splice: ["Grass", "Dirt"]},
			"Rose": {rarity: 3, splice: ["Grass", "Lava"]},
			"Mushroom": {rarity: 3, splice: ["Grass", "Cave Background"]},
			"Brick": {rarity: 3, splice: ["Grass", "Rock"]},
			"Rock Background": {rarity: 3, splice: ["Door", "Rock"]},
			"Wooden Background": {rarity: 4, splice: ["Door", "Grass"]},
			"Wooden Platform": {rarity: 4, splice: ["Wood Block", "Grass"]},
			"Crappy Sign": {rarity: 3, splice: ["Door", "Dirt"]},
			"Pointy Sign": {rarity: 4, splice: ["Door", "Sign"]},
			"Super Crate Box": {rarity: 3, splice: ["Sign", "Dirt"]},
			"Amber Glass": {rarity: 3, splice: ["Glass Pane", "Dirt"]},
			"Happy Joy Plaque": {rarity: 3, splice: ["Door", "Cave Background"]},
			"Cargo Shorts": {rarity: 3, splice: ["Wood Block", "Dirt"]},
			"Torch": {rarity: 3, splice: ["Sign", "Lava"]},
			"Wheat": {rarity: 3, splice: ["Grass", "Sand"]},
		};

		function makeLinkID(name) {
			var regex = /\s/g;
			return name.replace(regex, "_");
		}

		function makeWikiLink(itemName) {
			var regex = /\s/g;
			return "http://growtopia.wikia.com/wiki/" + itemName.replace(regex, "_");
		}

		function findAllChildItems(parentItem, items) {
			var children = [];

			for (var itemName in items) {
				if (!items.hasOwnProperty(itemName)) continue;

				var item = items[itemName];
				if (item.splice && item.splice.includes(parentItem)) children.push(itemName);
			}

			return children;
		}

		var itemsList = document.getElementById("itemsList");
		var itemInfoBoxes = document.getElementById("itemInfoBoxes");
		var allNames = Object.keys(items);
		allNames.sort();

		for (var itemIndex in allNames) {
			var itemName = allNames[itemIndex];
			var item = items[itemName];
			var anchorName = makeLinkID(itemName);

			// TOC
			{
				var a = document.createElement("a");
				a.href = "#" + anchorName;
				a.innerText = itemName;
				var li = document.createElement("li");
				li.appendChild(a);
				itemsList.appendChild(li);
			}

			// Info box
			{
				var infoBox = document.createElement("div");
				infoBox.class = "itemInfoBox";

				var img = document.createElement("img");
				var itemHeading = document.createElement("h2");
				itemHeading.innerText = itemName;
				var anchor = document.createElement("a");
				anchor.id = anchorName;
				anchor.href = "#" + anchorName;
				anchor.appendChild(img);
				anchor.appendChild(itemHeading);
				infoBox.appendChild(anchor);

				var rarity = document.createElement("div");
				rarity.innerText = "Rarity: " + item.rarity;
				infoBox.appendChild(rarity);

				var source = document.createElement("p");
				if (item.splice) {
					source.innerHTML = "Plant a " + itemName + " seed, or splice a "
					+ "<a href=\"#" + makeLinkID(item.splice[0]) + "\">" + item.splice[0] + "</a> seed with a "
					+ "<a href=\"#" + makeLinkID(item.splice[1]) + "\">" + item.splice[1] + "</a> seed.";
				} else if (item.spawnsInWorld) {
					source.innerText = "Spawns naturally in new " + item.spawnsInWorld + " worlds."
				} else if (item.spawnsInEvent) {
					source.innerHTML = "Spawns in the '" + item.spawnsInEvent + "' special event."
				}
				infoBox.appendChild(source);

				var wikiLink = document.createElement("a");
				wikiLink.href = makeWikiLink(itemName);
				wikiLink.target = "_blank";
				wikiLink.innerText = "View on Growtopia Wiki";
				infoBox.appendChild(wikiLink);

				// Where is this used?
				// This is a really really dumb check right now.
				// Probably makes more sense to put everything in a DB on a server rather than here, but oh well.
				var childItems = findAllChildItems(itemName, items);
				if (childItems.length > 0) {
					var usedToMake = document.createElement("h3");
					usedToMake.innerText = "Used to make:";
					infoBox.appendChild(usedToMake);
					var usedToMakeList = document.createElement("ul");
					for (var i = 0; i < childItems.length; i++) {
						var childName = childItems[i];

						var a = document.createElement("a");
						a.href = "#" + makeLinkID(childName);
						a.innerText = childName;
						var li = document.createElement("li");
						li.appendChild(a);
						usedToMakeList.appendChild(li);
					}

					infoBox.appendChild(usedToMakeList);
				}

				itemInfoBoxes.appendChild(infoBox);
			}
		}

	</script>
</body>
</html>